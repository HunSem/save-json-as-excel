(function(b){var a=(function(){var i=(function(){var j='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content="Microsoft Excel 11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>${table}</table></body></html>';return function(n,m){var l="",k=[];l+="<thead>";m.forEach(function(o){l+="<th>"+o.title+"</th>";if(o.computed&&typeof o.computed==="function"){k.push(o.computed)}else{if(o.dataIndex&&typeof o.dataIndex==="string"){k.push(o.dataIndex)}else{k.push(null)}}});l+="</thead>";l+="<tbody>";n.forEach(function(o){l+="<tr>";k.forEach(function(p){l+="<td>";if(typeof p==="string"){l+=o[p]}else{if(typeof p==="function"){l+=p(o)||""}else{l+=""}}l+="</td>"});l+="</tr>"});l+="</tbody>";return j.replace("${table}",l)}})();var g=function(l,k){var m="",j=[];k.forEach(function(n){m+=n.title;m+=",";if(n.computed&&typeof n.computed==="function"){j.push(n.computed)}else{if(n.dataIndex&&typeof n.dataIndex==="string"){j.push(n.dataIndex)}else{j.push(null)}}});m=m.slice(0,m.length-1);m+="\r\n";l.forEach(function(n){j.forEach(function(o){if(typeof o==="string"){m+=n[o]}else{if(typeof o==="function"){m+=o(n)||""}else{m+=""}}m+=","});m=m.slice(0,m.length-1);m+="\r\n"});return m};var e=function(j){return window.btoa(window.unescape(encodeURIComponent(j)))};var d=function(k,j,l){c(g(k,j),"application/vnd.ms-excel",l)};var h=function(k,j,l){c(g(k,j),"text/csv",l)};var c=function(n,m,o){if(window.navigator.msSaveBlob){var k=f(n,m);window.navigator.msSaveBlob(k,o);return false}var l=document.createElement("a");if(window.URL.createObjectURL){var k=f(n,m);var j=window.URL.createObjectURL(k);l.href=j;l.download=o;l.click();return}if(l.download===""){l.href="data:"+m+";base64,"+e(n);l.download=o;l.click();return}};var f=function(l,k){var j="\ufeff"+l;return new Blob([j],{type:k,})};return{saveAsXls:d,saveAsCsv:h,}})();if(typeof define==="function"&&define.amd){define(function(){return a})}else{if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=a}exports.saveJsonAsExcel=a}else{b.saveJsonAsExcel=a}}})(this);