(function(b){var c={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(f){var d="";var n,l,j,m,k,h,g;var e=0;f=c._utf8_encode(f);while(e<f.length){n=f.charCodeAt(e++);l=f.charCodeAt(e++);j=f.charCodeAt(e++);m=n>>2;k=((n&3)<<4)|(l>>4);h=((l&15)<<2)|(j>>6);g=j&63;if(isNaN(l)){h=g=64}else{if(isNaN(j)){g=64}}d=d+this._keyStr.charAt(m)+this._keyStr.charAt(k)+this._keyStr.charAt(h)+this._keyStr.charAt(g)}return d},decode:function(f){var d="";var n,l,j;var m,k,h,g;var e=0;f=f.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(e<f.length){m=this._keyStr.indexOf(f.charAt(e++));k=this._keyStr.indexOf(f.charAt(e++));h=this._keyStr.indexOf(f.charAt(e++));g=this._keyStr.indexOf(f.charAt(e++));n=(m<<2)|(k>>4);l=((k&15)<<4)|(h>>2);j=((h&3)<<6)|g;d=d+String.fromCharCode(n);if(h!=64){d=d+String.fromCharCode(l)}if(g!=64){d=d+String.fromCharCode(j)}}d=c._utf8_decode(d);return d},_utf8_encode:function(e){var d="";e=e.replace(/\r\n/g,"\n");for(var g=0;g<e.length;g++){var f=e.charCodeAt(g);if(f<128){d+=String.fromCharCode(f)}else{if(f>127&&f<2048){d+=String.fromCharCode((f>>6)|192);d+=String.fromCharCode((f&63)|128)}else{d+=String.fromCharCode((f>>12)|224);d+=String.fromCharCode(((f>>6)&63)|128);d+=String.fromCharCode((f&63)|128)}}}return d},_utf8_decode:function(d){var f="";var h=0;var k,j,g,e;k=j=g=0;while(h<d.length){k=d.charCodeAt(h);if(k<128){f+=String.fromCharCode(k);h++}else{if(k>191&&k<224){g=d.charCodeAt(h+1);f+=String.fromCharCode(((k&31)<<6)|(g&63));h+=2}else{g=d.charCodeAt(h+1);e=d.charCodeAt(h+2);f+=String.fromCharCode(((k&15)<<12)|((g&63)<<6)|(e&63));h+=3}}}return f},};var a=(function(){var j=(function(){var k='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content="Microsoft Excel 11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>${table}</table></body></html>';return function(o,n){var m="",l=[];m+="<thead>";n.forEach(function(p){m+="<th>"+p.title+"</th>";if(p.computed&&typeof p.computed==="function"){l.push(p.computed)}else{if(p.dataIndex&&typeof p.dataIndex==="string"){l.push(p.dataIndex)}else{l.push(null)}}});m+="</thead>";m+="<tbody>";o.forEach(function(p){m+="<tr>";l.forEach(function(q){m+="<td>";if(typeof q==="string"){m+=p[q]}else{if(typeof q==="function"){m+=q(p)||""}else{m+=""}}m+="</td>"});m+="</tr>"});m+="</tbody>";return k.replace("${table}",m)}})();var h=function(m,l){var n="",k=[];l.forEach(function(o){n+=o.title;n+=",";if(o.computed&&typeof o.computed==="function"){k.push(o.computed)}else{if(o.dataIndex&&typeof o.dataIndex==="string"){k.push(o.dataIndex)}else{k.push(null)}}});n=n.slice(0,n.length-1);n+="\r\n";m.forEach(function(o){k.forEach(function(p){if(typeof p==="string"){n+=o[p]}else{if(typeof p==="function"){n+=p(o)||""}else{n+=""}}n+=","});n=n.slice(0,n.length-1);n+="\r\n"});return n};var f=function(k){return c.encode("\ufeff"+k)};var e=function(l,k,m){d(h(l,k),"application/vnd.ms-excel",m)};var i=function(l,k,m){d(h(l,k),"text/csv",m)};var d=function(o,n,p){if(window.navigator.msSaveBlob){var l=g(o,n);window.navigator.msSaveBlob(l,p);return false}var m=document.createElement("a");if(window.URL.createObjectURL){var l=g(o,n);var k=window.URL.createObjectURL(l);m.href=k;m.download=p;m.click();return}if(m.download===""){m.href="data:"+n+";base64,"+f(o);m.download=p;m.click();return}};var g=function(m,l){var k="\ufeff"+m;return new Blob([k],{type:l,})};return{saveAsXls:e,saveAsCsv:i,}})();if(typeof define==="function"&&define.amd){define(function(){return a})}else{if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=a}exports.saveJsonAsExcel=a}else{b.saveJsonAsExcel=a}}})(this);